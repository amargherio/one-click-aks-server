apiVersion: "2021-10-01"
name: actlabs-aci
location: eastus
identity:
  type: UserAssigned
  userAssignedIdentities:
    "/subscriptions/da846304-0089-48e0-bfa7-65f68a3eb74f/resourcegroups/repro-project/providers/Microsoft.ManagedIdentity/userAssignedIdentities/ashisverma-msi": {}
properties:
  containers:
    - name: reverse-proxy
      properties:
        image: ashishvermapu/caddy:latest
        ports:
          - protocol: TCP
            port: 80
          - protocol: TCP
            port: 443
        resources:
          requests:
            memoryInGB: 1.0
            cpu: 1.0
          limits:
            memoryInGB: 1.0
            cpu: 1.0
    - name: actlabs-server
      properties:
        image: ashishvermapu/repro:alpha
        ports:
        - port: 8881
          protocol: TCP
        environmentVariables:
        - name: PORT
          value: 8881
        - name: ARM_CLIENT_ID
          value: a69e92e3-354d-4728-abaa-ed6ea86d21bf
        - name: AUTH_TOKEN_AUD
          value: 00399ddd-434c-4b8a-84be-d096cff4f494
        - name: AUTH_TOKEN_ISS
          value: https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47/v2.0
        - name: LOG_LEVEL
          value: -4
        - name: ARM_USER_PRINCIPAL_NAME
          value: ashisverma@microsoft.com
        - name: ARM_TENANT_ID
          value: 72f988bf-86f1-41af-91ab-2d7cd011db47
        - name: AZURE_SUBSCRIPTION_ID
          value: da846304-0089-48e0-bfa7-65f68a3eb74f
        - name: ARM_SUBSCRIPTION_ID
          value: da846304-0089-48e0-bfa7-65f68a3eb74f
        - name: AZURE_CLIENT_ID
          value: a69e92e3-354d-4728-abaa-ed6ea86d21bf
        - name: ROOT_DIR
          value: /app
        - name: ACTLABS_AUTH_URL
          value: https://actlabs-auth.azurewebsites.net/
        - name: PROTECTED_LAB_SECRET
          value: odEhRZrt!&!94*haZw4YGz7KqzAM!CYg@MxtvbJWu5k9Q!My6Hp$3ffCMwXp$Lo8cgPSM7FSHisi%NxBcYnJ5WVKykReSFDC97^6ZXQ!&HX9SKncaRT4S79ALYp8aFS&
        - name: USE_MSI
          value: true
        - name: ARM_USE_MSI
          value: true
        resources:
          requests:
            memoryInGB: 1.0
            cpu: 1.0
          limits:
            memoryInGB: 1.0
            cpu: 1.0
  ipAddress:
    ports:
      - protocol: TCP
        port: 80
      - protocol: TCP
        port: 443
    type: Public        
    dnsNameLabel: actlabs-aci
  osType: Linux
tags: null
type: Microsoft.ContainerInstance/containerGroups